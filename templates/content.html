<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maxinum-scale=1, user-scalable=no">

		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.6/umd/popper.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    		<script type="text/javascript">
    			google.charts.load("current", {packages:["corechart"]});
      			google.charts.setOnLoadCallback(drawChart);
      			function drawChart() {
        			var data = google.visualization.arrayToDataTable([
					{% for result in data %}
          				['Result', 'Count'],
          				['양호',     {{ result["good_count"]|int}}],
          				['취약',      {{ result["bad_count"]|int}}]
					{% endfor %}
        			]);

       	 			var options = {
					'title': "취약/양호 Chart",
			               	'width': $(window).width()*0.5,
               				'height': $(window).height()*0.6,
					is3D: true,
					pieHole: 0.6,
					slices: {
            					0: { color: 'green' },
            					1: { color: 'red' }
					},
					'chartArea': {'width': '80%', 'height': '80%'},
               				'legend': {'position': 'bottom'}
        			};

        		var chart = new google.visualization.PieChart(document.getElementById('donutchart'));
        		chart.draw(data, options);
      			}
		</script>
		<script type='text/javascript'>

		<!-- result color -->
		function f_color() {
			for (var i=0; i<7; i++) {
				if(document.getElementById('result'+i).innerHTML=="취약"){
					document.getElementById('result'+i).style.color="red";
				}
				else {
					document.getElementById('result'+i).style.color="green";
				}
			}
		}
		</script>


		<title>post page</title>
		<style>
		.table thead th {
 			vertical-align: bottom;
   			border-bottom: 2px solid #e9ecef;
    			font-size: 18px;
			text-align: center;
		}

		.table td {
    			padding: 0.5rem;
    			vertical-align: middle;
    			border-top: 1px solid #e9ecef;
    			font-size: 15px;
    			text-align: center;
		}
		.container {
    			max-width: 95%;
		}
		.text_align_left {
			text-align: left;
			vertical-align: middle;
		}
		#vertical-2 thead,#vertical-2 tbody{
                	display:inline-block;
            	}
		</style>
	</head>
	<body onload="f_color();">
	<nav class="navbar navbar-expand-sm bg-dark navbar-dark sticky-top">
		<!--LOGO-->
		<a class="navbar-brand" href="/">Vulnerability scan report databases</a>
		<!--Links-->
		<div class="container-fluid full-width">
			<ul>
				<li></li>
			</ul>
		<div>
		{% if logininfo %}
                <button class="btn btn-dark btn-right" type="button" onclick="location.href='/logout'">로그아웃</button>
                {% else %}
                <button class="btn btn-dark btn-right" type="button" onclick="location.href='https://github.com/with-developer/shell_script_temp/archive/refs/heads/main.zip'">
			진단 스크립트 다운로드</button>
                <button class="btn btn-dark btn-right" type="button" onclick="location.href='https://github.com/with-developer/CentOS_Vulnerability_scan_script'">사용법</button>
                {% endif %}
		</div>
	</nav>
	</div>

	<div class="container">
		<br><h1><strong><a style="color:#110957;">Simple Information</a></strong></h1><br>
	<div style="width:100%; height: 80vh; text-align: -webkit-center;">
		<table id="vertical-1" class="table table-hover" style="width:45%; height:60%;margin:0px; margin-top: 3%; padding-left:3%;display: inline-block;vertical-align:top;">
			{% for result in data %}
			<tr>
				<th>Number</th>
					<td style="font-size:16px; text-align:left;">{{ result["id"]}}</td>
            		</tr>
			<tr>
				<th>SYSTEM INFO</th>
					<td  style="font-size:16px; text-align:left;">{{result["system_info"] }} </td>
			</tr>
		
			<tr>
				<th>SYSTEM IP</th>
					<td style="font-size:16px; text-align:left;">{{result["system_ip"]}}</td>
			</tr>

			<tr>
				<th>SCAN DATE</th>
					<td style="font-size:16px; text-align:left;">{{result["now_time"]}}</td>
			</tr>

			<tr>
				<th>점검항목</th>
				<td style="text-align:left;">1. {{check_list[0]}}</td>
			</tr>
			<tr><th style="border: 0px;"></th><td style="border: 0px; text-align:left;">2. {{check_list[1]}}</td></tr>
			<tr><th style="border: 0px;"></th><td style="border: 0px; text-align:left;">3. {{check_list[2]}}</td></tr>  
			<tr><th style="border: 0px;"></th><td style="border: 0px; text-align:left;">4. {{check_list[3]}}</td></tr>
			<tr><th style="border: 0px;"></th><td style="border: 0px; text-align:left;">5. {{check_list[4]}}</td></tr>
			<tr><th style="border: 0px;"></th><td style="border: 0px; text-align:left;">6. {{check_list[5]}}</td></tr>
			<tr><th style="border: 0px;"></th><td style="border: 0px; text-align:left;">7. {{check_list[6]}}</td></tr>
			<tr><th></th><td></td></tr>

		{% endfor %}

	</table>
	<div id="donutchart" style="width: 50%; height: 60%;display: inline-block;" align="center"></div>
	</div>
	<div style="min-height:95vh">
		<hr style="border: solid 1px black;">
		 <br><h1><strong><a style="color:#110957;">More Information</a></strong></h1><br>
		<table class="table table-hover">
                <thead>
                <tr>
                        <th>번호</th>
                        <th>점검항목</th>
                        <th>점검기준</th>
			<th>중요도</th>
                        <th>점검결과</th>
                        <th>결과 상세보기</th>
                </tr>
                </thead>

                <tbody>
		{%for i in range(7) %}
                {% for result in data %}
                <tr>
			{% set temp_number= i + 1 %}
			{% set result_test="result_" %}
			{% set result_test_2="code_result_" %}
			{% set result_test_3="code_result_message_" %}
			{% set result_test = result_test+temp_number|string %}
			{% set result_test_2 = result_test_2+temp_number|string %}
			{% set result_test_3 = result_test_3+temp_number|string %}
                        <td>{{ temp_number }}</td>
			<td>{{ check_list[i]}}</td>
			<td style="text-align:left;padding-left:3%;"><pre style="vertical-align:middle; margin:0;">{{ check_criteria[i]}}</pre></td>
			<td>{{check_importance[i] }}</td>
			<td style="font-weight:bold; font-size:17px" id='result{{i}}'>{{ result[result_test] }}</td>
			<td>
				<input type="button" id="toggle{{temp_number}}" value="SHOW">
			</td>
                </tr>
		<tr style="border-top: 2px solid #9d9e9f; border-left:2px solid #9d9e9f; border-right:2px solid #9d9e9f; display:none" id="more_info_1_{{ temp_number }}">
			<td colspan='2'style="vertical-align:middle; font-size:16px; font-weight: bold;">현재 시스템 상태</td>
                        <td colspan='4' >
				<pre style="text-align:left;margin-left:3%">{{result[result_test_3] }}</pre>
			</td>
		</tr>
		<tr style="border-bottom: 2px solid #9d9e9f; border-left:2px solid #9d9e9f; border-right:2px solid #9d9e9f; display:none" id="more_info_2_{{ temp_number }}">
			<td colspan='2'style="vertical-align:middle; font-size:16px; font-weight: bold;">코드 실행 결과</td>
			<td colspan='4' >
				<pre style="text-align:left;margin-left:3%">{{result[result_test_2] }}</pre>
			</td>
		</tr>
                {% endfor %}
		{% endfor %}
                </tbody>
        </table>
	</div>
	</div>
	</body>
	<script>
		$(function(){
		$("#toggle1").click(function() {
			if($("#toggle1").val() == "SHOW"){
				$("#toggle1").val("HIDDEN");
			}
			else{
				$("#toggle1").val("SHOW");
			}
			$("#more_info_1_1").toggle();
			$("#more_info_2_1").toggle();
                });
		$("#toggle2").click(function() {
			if($("#toggle2").val() == "SHOW"){
                                $("#toggle2").val("HIDDEN");
                        }
                        else{
                                $("#toggle2").val("SHOW");
                        }
                        $("#more_info_1_2").toggle();
                        $("#more_info_2_2").toggle();
                });
		$("#toggle3").click(function() {
			if($("#toggle3").val() == "SHOW"){
                                $("#toggle3").val("HIDDEN");
                        }
                        else{
                                $("#toggle3").val("SHOW");
                        }
                        $("#more_info_1_3").toggle();
                        $("#more_info_2_3").toggle();
                });
		$("#toggle4").click(function() {
			if($("#toggle4").val() == "SHOW"){
                                $("#toggle4").val("HIDDEN");
                        }
                        else{
                                $("#toggle4").val("SHOW");
                        }
                        $("#more_info_1_4").toggle();
                        $("#more_info_2_4").toggle();
                });
		$("#toggle5").click(function() {
			if($("#toggle5").val() == "SHOW"){
                                $("#toggle5").val("HIDDEN");
                        }
                        else{
                                $("#toggle5").val("SHOW");
                        }
                        $("#more_info_1_5").toggle();
                        $("#more_info_2_5").toggle();
                });
		$("#toggle6").click(function() {
			if($("#toggle6").val() == "SHOW"){
                                $("#toggle6").val("HIDDEN");
                        }
                        else{
                                $("#toggle6").val("SHOW");
                        }
                        $("#more_info_1_6").toggle();
                        $("#more_info_2_6").toggle();
                });
		$("#toggle7").click(function() {
			if($("#toggle7").val() == "SHOW"){
                                $("#toggle7").val("HIDDEN");
                        }
                        else{
                                $("#toggle7").val("SHOW");
                        }
                        $("#more_info_1_7").toggle();
                        $("#more_info_2_7").toggle();
                });
		});
	</script>
</html>
